version: 1
applications:
  # ============================================
  # MARKETING SITE - symphonia-controltower.com
  # ============================================
  - appRoot: apps/marketing-site
    frontend:
      phases:
        preBuild:
          commands:
            - npm install -g pnpm@8.15.4
            - cd ../..
            - pnpm install
            - pnpm turbo build --filter=@rt/marketing-site^...
            - cd apps/marketing-site
        build:
          commands:
            - pnpm run build
      artifacts:
        baseDirectory: out
        files:
          - '**/*'
      cache:
        paths:
          - ../../node_modules/**/*
          - .next/cache/**/*
          - ../../.turbo/**/*
    customHeaders:
      - pattern: '**/*'
        headers:
          - key: 'Cache-Control'
            value: 'public, max-age=31536000, immutable'
      - pattern: '*.html'
        headers:
          - key: 'Cache-Control'
            value: 'public, max-age=0, must-revalidate'
    environment:
      variables:
        NEXT_PUBLIC_SITE_URL: 'https://symphonia-controltower.com'
        NEXT_PUBLIC_PORTAL_TYPE: 'marketing'
        # Core APIs (CloudFront HTTPS)
        NEXT_PUBLIC_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_VAT_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_SUBSCRIPTIONS_API_URL: 'https://dgze8l03lwl5h.cloudfront.net'
        NEXT_PUBLIC_ORDERS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net/api/v1'
        NEXT_PUBLIC_AUTHZ_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_TRACKING_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_APPOINTMENTS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_DOCUMENTS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_SCORING_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_AFFRET_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_WS_URL: 'wss://d2i50a1vlg138w.cloudfront.net'
        NODE_VERSION: '20'
        PNPM_VERSION: '8.15.4'

  # ============================================
  # WEB INDUSTRY - industry.symphonia-controltower.com
  # ============================================
  - appRoot: apps/web-industry
    frontend:
      phases:
        preBuild:
          commands:
            - npm install -g pnpm@8.15.4
            - cd ../..
            - pnpm install
            - pnpm turbo build --filter=@rt/web-industry^...
            - cd apps/web-industry
        build:
          commands:
            - pnpm run build
      artifacts:
        baseDirectory: out
        files:
          - '**/*'
      cache:
        paths:
          - ../../node_modules/**/*
          - .next/cache/**/*
          - ../../.turbo/**/*
    customHeaders:
      - pattern: '**/*'
        headers:
          - key: 'Cache-Control'
            value: 'public, max-age=31536000, immutable'
      - pattern: '*.html'
        headers:
          - key: 'Cache-Control'
            value: 'public, max-age=0, must-revalidate'
    environment:
      variables:
        NEXT_PUBLIC_SITE_URL: 'https://industry.symphonia-controltower.com'
        NEXT_PUBLIC_PORTAL_TYPE: 'industry'
        # Core APIs (CloudFront HTTPS)
        NEXT_PUBLIC_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_ORDERS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net/api/v1'
        NEXT_PUBLIC_AUTHZ_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_TRACKING_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_APPOINTMENTS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_DOCUMENTS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_SCORING_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_AFFRET_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_WS_URL: 'wss://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_PLANNING_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_BILLING_API: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_BILLING_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_STORAGE_MARKET_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_PALETTES_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NODE_VERSION: '20'
        PNPM_VERSION: '8.15.4'

  # ============================================
  # WEB TRANSPORTER - transporter.symphonia-controltower.com
  # ============================================
  - appRoot: apps/web-transporter
    frontend:
      phases:
        preBuild:
          commands:
            - npm install -g pnpm@8.15.4
            - cd ../..
            - pnpm install
            - pnpm turbo build --filter=@rt/web-transporter^...
            - cd apps/web-transporter
        build:
          commands:
            - pnpm run build
      artifacts:
        baseDirectory: out
        files:
          - '**/*'
      cache:
        paths:
          - ../../node_modules/**/*
          - .next/cache/**/*
          - ../../.turbo/**/*
    customHeaders:
      - pattern: '**/*'
        headers:
          - key: 'Cache-Control'
            value: 'public, max-age=31536000, immutable'
      - pattern: '*.html'
        headers:
          - key: 'Cache-Control'
            value: 'public, max-age=0, must-revalidate'
    environment:
      variables:
        NEXT_PUBLIC_SITE_URL: 'https://transporter.symphonia-controltower.com'
        NEXT_PUBLIC_PORTAL_TYPE: 'transporter'
        # Core APIs (CloudFront HTTPS)
        NEXT_PUBLIC_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_ORDERS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net/api/v1'
        NEXT_PUBLIC_AUTHZ_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_TRACKING_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_APPOINTMENTS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_DOCUMENTS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_SCORING_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_AFFRET_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_WS_URL: 'wss://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_ECMR_API: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_PLANNING_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_CHATBOT_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_BILLING_API: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_PALETTES_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NODE_VERSION: '20'
        PNPM_VERSION: '8.15.4'

  # ============================================
  # WEB LOGISTICIAN - logistician.symphonia-controltower.com
  # ============================================
  - appRoot: apps/web-logistician
    frontend:
      phases:
        preBuild:
          commands:
            - npm install -g pnpm@8.15.4
            - cd ../..
            - pnpm install
            - pnpm turbo build --filter=@rt/web-logistician^...
            - cd apps/web-logistician
        build:
          commands:
            - pnpm run build
      artifacts:
        baseDirectory: out
        files:
          - '**/*'
      cache:
        paths:
          - ../../node_modules/**/*
          - .next/cache/**/*
          - ../../.turbo/**/*
    customHeaders:
      - pattern: '**/*'
        headers:
          - key: 'Cache-Control'
            value: 'public, max-age=31536000, immutable'
      - pattern: '*.html'
        headers:
          - key: 'Cache-Control'
            value: 'public, max-age=0, must-revalidate'
    environment:
      variables:
        NEXT_PUBLIC_SITE_URL: 'https://logistician.symphonia-controltower.com'
        NEXT_PUBLIC_PORTAL_TYPE: 'logistician'
        # Core APIs (CloudFront HTTPS)
        NEXT_PUBLIC_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_AUTH_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_ORDERS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net/api/v1'
        NEXT_PUBLIC_AUTHZ_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_TRACKING_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_APPOINTMENTS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_DOCUMENTS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_SCORING_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_AFFRET_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_WS_URL: 'wss://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_STORAGE_MARKET_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_PLANNING_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_CHATBOT_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_BILLING_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_PALETTES_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NODE_VERSION: '20'
        PNPM_VERSION: '8.15.4'

  # ============================================
  # WEB RECIPIENT - recipient.symphonia-controltower.com
  # ============================================
  - appRoot: apps/web-recipient
    frontend:
      phases:
        preBuild:
          commands:
            - npm install -g pnpm@8.15.4
            - cd ../..
            - pnpm install
            - pnpm turbo build --filter=@rt/web-recipient^...
            - cd apps/web-recipient
        build:
          commands:
            - pnpm run build
      artifacts:
        baseDirectory: out
        files:
          - '**/*'
      cache:
        paths:
          - ../../node_modules/**/*
          - .next/cache/**/*
          - ../../.turbo/**/*
    customHeaders:
      - pattern: '**/*'
        headers:
          - key: 'Cache-Control'
            value: 'public, max-age=31536000, immutable'
      - pattern: '*.html'
        headers:
          - key: 'Cache-Control'
            value: 'public, max-age=0, must-revalidate'
    environment:
      variables:
        NEXT_PUBLIC_SITE_URL: 'https://recipient.symphonia-controltower.com'
        NEXT_PUBLIC_PORTAL_TYPE: 'recipient'
        # Core APIs (CloudFront HTTPS)
        NEXT_PUBLIC_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_ORDERS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net/api/v1'
        NEXT_PUBLIC_AUTHZ_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_TRACKING_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_APPOINTMENTS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_DOCUMENTS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_WS_URL: 'wss://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_RECIPIENT_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NODE_VERSION: '20'
        PNPM_VERSION: '8.15.4'

  # ============================================
  # WEB SUPPLIER - supplier.symphonia-controltower.com
  # ============================================
  - appRoot: apps/web-supplier
    frontend:
      phases:
        preBuild:
          commands:
            - npm install -g pnpm@8.15.4
            - cd ../..
            - pnpm install
            - pnpm turbo build --filter=@rt/web-supplier^...
            - cd apps/web-supplier
        build:
          commands:
            - pnpm run build
      artifacts:
        baseDirectory: out
        files:
          - '**/*'
      cache:
        paths:
          - ../../node_modules/**/*
          - .next/cache/**/*
          - ../../.turbo/**/*
    customHeaders:
      - pattern: '**/*'
        headers:
          - key: 'Cache-Control'
            value: 'public, max-age=31536000, immutable'
      - pattern: '*.html'
        headers:
          - key: 'Cache-Control'
            value: 'public, max-age=0, must-revalidate'
    environment:
      variables:
        NEXT_PUBLIC_SITE_URL: 'https://supplier.symphonia-controltower.com'
        NEXT_PUBLIC_PORTAL_TYPE: 'supplier'
        # Core APIs (CloudFront HTTPS)
        NEXT_PUBLIC_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_ORDERS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net/api/v1'
        NEXT_PUBLIC_AUTHZ_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_TRACKING_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_APPOINTMENTS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_DOCUMENTS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_WS_URL: 'wss://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_SUPPLIER_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NODE_VERSION: '20'
        PNPM_VERSION: '8.15.4'

  # ============================================
  # WEB FORWARDER - forwarder.symphonia-controltower.com
  # ============================================
  - appRoot: apps/web-forwarder
    frontend:
      phases:
        preBuild:
          commands:
            - npm install -g pnpm@8.15.4
            - cd ../..
            - pnpm install
            - pnpm turbo build --filter=@rt/web-forwarder^...
            - cd apps/web-forwarder
        build:
          commands:
            - pnpm run build
      artifacts:
        baseDirectory: out
        files:
          - '**/*'
      cache:
        paths:
          - ../../node_modules/**/*
          - .next/cache/**/*
          - ../../.turbo/**/*
    customHeaders:
      - pattern: '**/*'
        headers:
          - key: 'Cache-Control'
            value: 'public, max-age=31536000, immutable'
      - pattern: '*.html'
        headers:
          - key: 'Cache-Control'
            value: 'public, max-age=0, must-revalidate'
    environment:
      variables:
        NEXT_PUBLIC_SITE_URL: 'https://forwarder.symphonia-controltower.com'
        NEXT_PUBLIC_PORTAL_TYPE: 'forwarder'
        # Core APIs (CloudFront HTTPS)
        NEXT_PUBLIC_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_ORDERS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net/api/v1'
        NEXT_PUBLIC_AUTHZ_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_TRACKING_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_APPOINTMENTS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_DOCUMENTS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_SCORING_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_AFFRET_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_WS_URL: 'wss://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_BOURSE_MARITIME_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NODE_VERSION: '20'
        PNPM_VERSION: '8.15.4'

  # ============================================
  # BACKOFFICE ADMIN - admin.symphonia-controltower.com
  # ============================================
  - appRoot: apps/backoffice-admin
    frontend:
      phases:
        preBuild:
          commands:
            - npm install -g pnpm@8.15.4
            - cd ../..
            - pnpm install
            - pnpm turbo build --filter=@rt/ui-components --filter=@rt/backoffice-admin^...
            - cd apps/backoffice-admin
        build:
          commands:
            - pnpm run build
      artifacts:
        baseDirectory: out
        files:
          - '**/*'
      cache:
        paths:
          - ../../node_modules/**/*
          - .next/cache/**/*
          - ../../.turbo/**/*
    customHeaders:
      - pattern: '**/*'
        headers:
          - key: 'Cache-Control'
            value: 'public, max-age=31536000, immutable'
      - pattern: '*.html'
        headers:
          - key: 'Cache-Control'
            value: 'public, max-age=0, must-revalidate'
    environment:
      variables:
        NEXT_PUBLIC_SITE_URL: 'https://admin.symphonia-controltower.com'
        NEXT_PUBLIC_PORTAL_TYPE: 'admin'
        # Core APIs (CloudFront HTTPS)
        NEXT_PUBLIC_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_SUBSCRIPTIONS_API_URL: 'https://dgze8l03lwl5h.cloudfront.net'
        NEXT_PUBLIC_ORDERS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net/api/v1'
        NEXT_PUBLIC_AUTHZ_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_TRACKING_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_APPOINTMENTS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_DOCUMENTS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_SCORING_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_AFFRET_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_WS_URL: 'wss://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_ADMIN_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_ADMIN_GATEWAY_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_BILLING_API: 'https://d2i50a1vlg138w.cloudfront.net'
        NEXT_PUBLIC_SALES_AGENTS_API_URL: 'https://d2i50a1vlg138w.cloudfront.net'
        NODE_VERSION: '20'
        PNPM_VERSION: '8.15.4'
